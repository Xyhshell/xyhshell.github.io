<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Bing(å¿…åº”)æ¯æ—¥ä¸€å›¾ä¸‹è½½ | Code blog</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://xyhshell.github.io/favicon.ico?v=1653288973771">
<link rel="stylesheet" href="https://xyhshell.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-S4VZ5G7WQH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-S4VZ5G7WQH');
</script>


    <meta name="description" content="ä¸€æ¬¾æ›´æ–°windowsæ¡Œé¢å£çº¸è½¯ä»¶

1.ç¯å¢ƒ &amp; å£°æ˜
python 3.7.5(32bit) å…¼å®¹32å’Œ64ä½ç³»ç»Ÿ
äº¤æµä¸åˆ†äº«ï¼Œè¯·å‹¿ç”¨äºéæ³•é€”å¾„
2.çµæ„Ÿ &amp; è¯´æ˜

å¾—ç›Šäºä¸€ä¸ªå¶ç„¶çš„æµè§ˆï¼Œå‘ç°æœ‰åšä¸»åˆ©ç”¨phpå®ç°å¯¹å¿…åº”..." />
    <meta name="keywords" content="ç¼–ç " />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://xyhshell.github.io">
        <img src="https://xyhshell.github.io/images/avatar.png?v=1653288973771" class="site-logo">
        <h1 class="site-title">Code blog</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="https://xyhshell.github.io" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="https://xyhshell.github.io/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="https://xyhshell.github.io/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="https://xyhshell.github.io/post/About" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
  
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/xyhshell" target="_blank">
            <i class="fab fa-github"></i>
          </a>

		<a class="rss" href="https://xyhshell.github.io/atom.xml" target="_blank">RSS</a>
		
        
      
        
      
        
      
        
      
        
      
    </div>
    
    <div class="site-description">
      æ•¬ç•è‡ªç„¶ï¼ŒæŠ€æœ¯è‡³ä¸Š
    </div>
    
    <div class="site-footer">
      â¤ï¸ å¸Œæœ›ä½ èƒ½å¥½å¥½çš„ To you ! â¤ï¸ <br><br>  Copyrights Â© 2021-2022 <a href="https://github.com/xyhshell" target="_blank">Jingmo - Xiao</a>
    </div>
    
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Bing(å¿…åº”)æ¯æ—¥ä¸€å›¾ä¸‹è½½</h2>
            <div class="post-date">2021-09-21</div>
            
            <div class="post-content" v-pre>
              <p>ä¸€æ¬¾æ›´æ–°windowsæ¡Œé¢å£çº¸è½¯ä»¶</p>
<!-- more -->
<h1 id="1ç¯å¢ƒ-å£°æ˜">1.ç¯å¢ƒ &amp; å£°æ˜</h1>
<p>python 3.7.5(32bit) å…¼å®¹32å’Œ64ä½ç³»ç»Ÿ</p>
<h2 id="äº¤æµä¸åˆ†äº«è¯·å‹¿ç”¨äºéæ³•é€”å¾„">äº¤æµä¸åˆ†äº«ï¼Œè¯·å‹¿ç”¨äºéæ³•é€”å¾„</h2>
<h1 id="2çµæ„Ÿ-è¯´æ˜">2.çµæ„Ÿ &amp; è¯´æ˜</h1>
<blockquote>
<p>å¾—ç›Šäºä¸€ä¸ªå¶ç„¶çš„æµè§ˆï¼Œå‘ç°æœ‰åšä¸»åˆ©ç”¨phpå®ç°å¯¹å¿…åº”æ¯æ—¥ä¸€å›¾çš„è§£æå’Œè·å–ï¼Œäºæ˜¯åˆ©ç”¨pythonå¯¹å…¶è¿›è¡Œå¤ç°ï¼ˆè™½ç„¶æœ‰å¯ç›´æ¥ç”¨çš„æ¥å£ï¼Œè€Œæ¯•ç«Ÿæ˜¯åˆ«äººçš„ï¼ğŸ˜¥ï¼‰,å¹¶æ·»åŠ ä¸€å®šçš„åŠŸèƒ½ï¼</p>
</blockquote>
<blockquote>
<p>21/06/04 ï¼šåˆä»£ç‰ˆæœ¬ ï¼Œæä¾›å›¾ç‰‡ä¸‹è½½å¹¶å¯è‡ªå®šä¹‰è®¾ä¸ºå£çº¸.</p>
<blockquote>
<p>21/07/06 : æœŸé—´å¤ªå¿™ï¼Œåç»­ä½¿ç”¨ä¸­å‘ç°ä»£ç è¿‡äºè‡ƒè‚¿ï¼Œæ§åˆ¶çª—å£æ˜¾ç¤ºéå¿…è¦ä¿¡æ¯è¿‡å¤šï¼Œç²¾ç®€å¹¶æ·»åŠ å¯¹å›¾ç‰‡ä¿¡æ¯å’Œé“¾æ¥æ–‡ä»¶çš„å‚¨å­˜ï¼</p>
</blockquote>
</blockquote>
<h1 id="æ­£ç‰‡å¼€å§‹">æ­£ç‰‡å¼€å§‹</h1>
<blockquote>
<p>é¦–å…ˆæ˜¯<a href="https://tool.liumingye.cn/bingimg/">åšä¸»</a>æä¾›çš„phpç‰ˆè§£ææ¥å£ï¼Œä½¿ç”¨è¦æ±‚è¾ƒé«˜ï¼Œå°¤å…¶æ˜¯ç¯å¢ƒçš„æ­å»ºã€‚</p>
</blockquote>
<pre><code class="language-php">&lt;?php
/*
    * @author www.liumingye.cn
*/
$filename = &quot;./cache.json&quot;;
if (file_exists($filename) === false) {
    file_put_contents($filename, &quot;&quot;);
}
$handle = fopen($filename, &quot;r&quot;);
$contents = fread($handle, filesize($filename));
fclose($handle);
$contents = json_decode($contents, true);

if (filesize($filename) === 0) {
    // echo &quot;è·å–\r\n&quot;;
    getBingImg();
} else {
    if ($contents['time'] === date(&quot;Ymd&quot;)) {
        // echo &quot;ç¼“å­˜\r\n&quot;;
        Header(&quot;Location: &quot;.$contents['url']);
    } else {
        // echo &quot;è¿‡æœŸ\r\n&quot;;
        getBingImg();
    }
}
function getBingImg() {
    $str = file_get_contents('http://cn.bing.com/HPImageArchive.aspx?idx=0&amp;n=1');
    if (preg_match(&quot;/&lt;url&gt;(.+?)&lt;\/url&gt;/ies&quot;, $str, $matches)) {
        $imgurl = 'https://cn.bing.com' . $matches[1];
    }
    if ($imgurl) {
        global $contents;
        if($contents['url'] !== $imgurl){
            global $filename;
            $data = array(
                &quot;time&quot; =&gt; date(&quot;Ymd&quot;) ,
                &quot;url&quot; =&gt; $imgurl
            );
            $data = json_encode($data);
            file_put_contents($filename, $data);
        }
        Header(&quot;Location: &quot;.$imgurl);
        exit();
    } else {
        exit('error');
    }
}
</code></pre>
<h1 id="202164-bing_lymé¡¹ç›®æºç ">2021/6/4/ bing_lymé¡¹ç›®æºç </h1>
<blockquote>
<p>å°šæœ‰ä¼˜åŒ–ï¼Œå¾…ä¼˜åŒ–â€¦â€¦</p>
</blockquote>
<pre><code class="language-python">#!/usr/bin/python
# -*- coding:utf-8 -*-
# @File   : bing_lym.py
# @Time   : 2021/6/4 8:53

import re
import os
import win32api
import win32con
import win32gui
import requests

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.108 Safari/537.36'
}
''


def downloads_img(time_info, img_d_url, img_text):
    path = os.getcwd() + f'/{time_info}.jpg'
    with open(path, 'wb') as f:
        f.write(requests.get(img_d_url, headers=headers).content)

    path_ = os.getcwd() + f'/{time_info}.txt'
    with open(path_, 'w', encoding='utf-8') as f_:
        f_.write(img_text + '\n' + img_d_url)

    print(&quot;*-&gt; æ–‡ä»¶é“¾æ¥&quot;, img_d_url)
    print(f&quot;*-&gt; æ–‡ä»¶  {time_info}.jpg --&gt; ä¸‹è½½æˆåŠŸï¼&quot;)


def get_res_html():
    aspx_url = 'http://cn.bing.com/HPImageArchive.aspx?idx=0&amp;n=1'
    img_html = requests.get(url=aspx_url, headers=headers).text
    # print(img_html)

    date_info = re.findall('&lt;fullstartdate&gt;(.*?)&lt;/fullstartdate&gt;', img_html)[0]
    img_info = re.findall('&lt;url&gt;(.*?)&lt;/url&gt;', img_html)[0]

    # 07_06 åŠ å…¥å…³äºå›¾ç‰‡è¯´æ˜
    img_text = re.findall('&lt;copyright&gt;(.*?)&lt;/copyright&gt;', img_html)[0]
    print(' date_info -&gt; %s\n img_info  -&gt; %s\n img_text  -&gt; %s' % (date_info, img_info, img_text))

    return date_info, img_info, img_text


def setWallPaper(pic):
    # open register
    regKey = win32api.RegOpenKeyEx(win32con.HKEY_CURRENT_USER, &quot;Control Panel\\Desktop&quot;, 0, win32con.KEY_SET_VALUE)
    win32api.RegSetValueEx(regKey, &quot;WallpaperStyle&quot;, 0, win32con.REG_SZ, &quot;2&quot;)
    win32api.RegSetValueEx(regKey, &quot;TileWallpaper&quot;, 0, win32con.REG_SZ, &quot;0&quot;)
    # refresh screen
    win32gui.SystemParametersInfo(win32con.SPI_SETDESKWALLPAPER, pic, win32con.SPIF_SENDWININICHANGE)


def img_main():
    bing_url = 'https://cn.bing.com'
    date_info, img_info, img_text = get_res_html()
    # ä¸‹è½½å‡½æ•°
    downloads_img(time_info=date_info, img_d_url=bing_url + img_info, img_text=img_text)
    # ç»å¯¹è·¯å¾„å‚¨å­˜
    path = os.getcwd() + f'/{date_info}.jpg'
    # print(type(path), path)

    pd = input('&gt; æ›´æ¢å£çº¸ï¼Ÿ y/n :')
    if pd == &quot;y&quot; or &quot;Y&quot;:
        setWallPaper(pic=path)
    else:
        pass


if __name__ == '__main__':
    img_main()
</code></pre>
<hr>
<h1 id="æ–‡ä»¶åœ°å€">æ–‡ä»¶åœ°å€</h1>
<p>ç äº‘ï¼šhttps://gitee.com/xyhshell/bing_lym<br>
æˆå“å¯æ‰§è¡Œæ–‡ä»¶ï¼šhttps://jingmo.lanzoui.com/ida7Ur2z33a</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://xyhshell.github.io/tag/bian-ma/" class="tag">
                    ç¼–ç 
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://xyhshell.github.io/post/beyond/">
                  <h3 class="post-title">
                    åäººä¼ ï¼ˆé»„å®¶é©¹ &amp; beyondï¼‰
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
